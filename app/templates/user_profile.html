{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">User Profile</h2>
    
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="alert alert-success text-center">
                {% for message in messages %}
                    {{ message }}<br>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    {% if current_user.is_authenticated %}
        <div class="list-group text-center">
            <div class="list-group-item">Email: <strong>{{ user.email }}</strong></div>
            <div class="list-group-item">First Name: <strong>{{ user.firstname }}</strong></div>
            <div class="list-group-item">Last Name: <strong>{{ user.lastname }}</strong></div>
            <div class="list-group-item">Address: <strong>{{ user.address }}</strong></div>
            <div class="list-group-item">Seller Status: <strong>{{ 'Yes' if user.isSeller else 'No' }}</strong></div>
            <div class="list-group-item">Balance: <strong>{{ user.balance }}</strong></div>
        </div>
        
        <div class="mt-4 mb-2 text-center">
            <a href="{{ url_for('users.edit_profile') }}" class="btn btn-primary">Edit Profile</a>
        </div>


    <!-- Purchase History Section -->
    <h3>Your Purchase History:</h3>
    <table class='table table-hover table-bordered'>
      <thead class="thead-custom" style="background-color: #00539B; color: aliceblue;">
        <tr>
          <th scope="col">Product Name</th>
          <th scope="col">Price</th>
          <th scope="col">Quantity</th>
          <th scope="col">Purchase Time</th>
          <th scope="col">Order Status</th>
        </tr>
      </thead>
      <tbody>
        {% for item in purchases %}
          <tr>
            <th scope="row">{{ item.product_name }}</th>
            <td>{{ item.brought_price }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.order_time }}</td>
            <td>{{ item.order_status }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>  

    <div class="mt-2 text-right">
        <a href="{{ url_for('index.index') }}" class="btn btn-secondary">Return to Home</a>
    </div>
    <br>

    {% else %}
        <div class="text-center">
            <p><a href="{{ url_for('users.login') }}">Log in</a> to view your profile.</p>
        </div>
    {% endif %}
</div>
{% endblock %}


